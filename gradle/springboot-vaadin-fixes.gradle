//
// vaadin plugin configs
// 
vaadin {
	// debug is managed by vaadin4spring
	vaadin.debug = false
	// we manage repos ourself (failed with gradle 2.1 and 0.8 of the plugin)
	vaadin.manageRepositories = false
	// bend the directory to compile the themes into the build dir
	vaadin.plugin.themesDirectory = 'build/resources/main/VAADIN/themes/'
	// bend the directory to compile the widgetset into the build dir
	vaadin.gwt.outputDirectory = file('build/resources/main/')
}

//
// springboot plugin configs
//

// pull in vaadin tasks several of the springboot tasks shall depend on
jar {
	dependsOn vaadinCompileWidgetset, vaadinCompileThemes
}
bootRun {
	dependsOn vaadinCompileWidgetset, vaadinCompileThemes
}
bootRepackage.dependsOn = [jar]
assemble.dependsOn = [bootRepackage, jar]

// pass sysprops down to bootRun, so we can add them in configs in intellij
bootRun.systemProperties = System.properties

// must be done last, so both plugins setup their stuff already
project.afterEvaluate {
	// get the runtime vaadin libs into the jar
	jar {
		into('lib') {
			from configurations.vaadin
			from configurations."vaadin-push"
		}
	}
	// pickup the runtime vaadin libs for bootRun
	bootRun {
		classpath += configurations.vaadin
		classpath += configurations."vaadin-push"
	}
}

